<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Least squares problems · KrylovKit.jl</title><meta name="title" content="Least squares problems · KrylovKit.jl"/><meta property="og:title" content="Least squares problems · KrylovKit.jl"/><meta property="twitter:title" content="Least squares problems · KrylovKit.jl"/><meta name="description" content="Documentation for KrylovKit.jl."/><meta property="og:description" content="Documentation for KrylovKit.jl."/><meta property="twitter:description" content="Documentation for KrylovKit.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">KrylovKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../linear/">Linear problems</a></li><li class="is-active"><a class="tocitem" href>Least squares problems</a></li><li><a class="tocitem" href="../eig/">Eigenvalue problems</a></li><li><a class="tocitem" href="../svd/">Singular value problems</a></li><li><a class="tocitem" href="../matfun/">Functions of matrices and linear operators</a></li><li><a class="tocitem" href="../reallinear/">Real linear maps</a></li><li><a class="tocitem" href="../algorithms/">Available algorithms</a></li><li><a class="tocitem" href="../implementation/">Implementation details</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Least squares problems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Least squares problems</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jutho/KrylovKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jutho/KrylovKit.jl/blob/master/docs/src/man/leastsquares.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Least-squares-problems"><a class="docs-heading-anchor" href="#Least-squares-problems">Least squares problems</a><a id="Least-squares-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Least-squares-problems" title="Permalink"></a></h1><p>Least square problems take the form of finding <code>x</code> that minimises <code>norm(b - A*x)</code> where <code>A</code> should be a linear map. As opposed to linear systems, the input and output of the linear map do not need to be the same, so that <code>x</code> (input) and <code>b</code> (output) can live in different vector spaces. Such problems can be solved using the function <code>lssolve</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KrylovKit.lssolve" href="#KrylovKit.lssolve"><code>KrylovKit.lssolve</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lssolve(A::AbstractMatrix, b::AbstractVector, [λ::Real = 0]; kwargs...)
lssolve(f, b, [λ = 0]; kwargs...)
# expert version:
lssolve(f, b, algorithm, [λ = 0])</code></pre><p>Compute a least squares solution <code>x</code> to the problem <code>A * x ≈ b</code> or <code>f(x) ≈ b</code> where <code>f</code> encodes a linear map, i.e. a solution <code>x</code> that minimizes <code>norm(b - f(x))</code>. Return the approximate solution <code>x</code> and a <code>ConvergenceInfo</code> structure.</p><p><strong>Arguments:</strong></p><p>The linear map can be an <code>AbstractMatrix</code> (dense or sparse) or a general function or callable object. Since both the action of the linear map and its adjoint are required in order to solve the least squares problem, <code>f</code> can either be a tuple of two callable objects (each accepting a single argument), representing the linear map and its adjoint respectively,  or, <code>f</code> can be a single callable object that accepts two input arguments, where the second argument is a flag of type <code>Val{true}</code> or <code>Val{false}</code> that indicates whether the adjoint or the normal action of the linear map needs to be computed. The latter form still combines well with the <code>do</code> block syntax of Julia, as in</p><pre><code class="language-julia hljs">x, info = lssolve(b; kwargs...) do x, flag
    if flag === Val(true)
        # y = compute action of adjoint map on x
    else
        # y = compute action of linear map on x
    end
    return y
end</code></pre><p>If the linear map <code>A</code> or <code>f</code> has a nontrivial nullspace, so different minimisers exist, the solution being returned is such that <code>norm(x)</code> is minimal. Alternatively, the problem can be providing a nonzero value for the optional argument <code>λ</code>, representing a scalar so  that the minimisation problem <code>norm(b - A * x)^2 + λ * norm(x)^2</code> is solved instead.</p><div class="admonition is-info" id="Starting-guess-4fe118270eed9515"><header class="admonition-header">Starting guess<a class="admonition-anchor" href="#Starting-guess-4fe118270eed9515" title="Permalink"></a></header><div class="admonition-body"><p>Note that <code>lssolve</code> does not allow to specify an starting guess <code>x₀</code> for the solution. The starting guess is always assumed to be the zero vector in the domain of the linear map, which is found by applying the adjoint action of the linear map to <code>b</code> and applying <code>zerovector</code> to the result. Given a good initial guess <code>x₀</code>, the user can call <code>lssolve</code> with a modified right hand side <code>b - f(x₀)</code> and add <code>x₀</code> to the solution returned by <code>lssolve</code>. The resulting vector <code>x</code> is a least squares solution to the original problem, but such that  <code>norm(x - x₀)</code> is minimal or <code>norm(b - A * x)^2 + λ * norm(x-x₀)^2</code> is minimised instead</p></div></div><p><strong>Return values:</strong></p><p>The return value is always of the form <code>x, info = lssolve(...)</code> with</p><ul><li><p><code>x</code>: the least squares solution to the problem, as defined above </p></li><li><p><code>info</code>: an object of type [<code>ConvergenceInfo</code>], which has the following fields</p><ul><li><code>info.converged::Int</code>: takes value 0 or 1 depending on whether the solution was converged up to the requested tolerance</li><li><code>info.residual</code>: residual <code>b - A*x</code> of the approximate solution <code>x</code></li><li><code>info.normres::Real</code>: norm of the residual of the normal equations, i.e. the quantity <code>norm(A&#39;*(b - A*x) - λ^2 * x)</code> that needs to be smaller than the requested tolerance <code>tol</code> in order to have a converged solution</li><li><code>info.numops::Int</code>: total number of times that the linear map was applied, i.e. the number of times that <code>f</code> was called, or a vector was multiplied with <code>A</code> or <code>A&#39;</code></li><li><code>info.numiter::Int</code>: total number of iterations of the algorithm</li></ul></li></ul><div class="admonition is-warning" id="Check-for-convergence-6fb6d2a0abb70a2a"><header class="admonition-header">Check for convergence<a class="admonition-anchor" href="#Check-for-convergence-6fb6d2a0abb70a2a" title="Permalink"></a></header><div class="admonition-body"><p>No warning is printed if no converged solution was found, so always check if <code>info.converged == 1</code>.</p></div></div><p><strong>Keyword arguments:</strong></p><p>Keyword arguments are given by:</p><ul><li><code>verbosity::Int = SILENT_LEVEL</code>: verbosity level, i.e. <ul><li>SILENT_LEVEL (suppress all messages)</li><li>WARN_LEVEL (only warnings)</li><li>STARTSTOP_LEVEL (information at the beginning and end)</li><li>EACHITERATION_LEVEL (progress info after every iteration)</li></ul></li><li><code>atol::Real</code>: the requested accuracy, i.e. absolute tolerance, on the norm of the residual.</li><li><code>rtol::Real</code>: the requested accuracy on the norm of the residual, relative to the norm of the right hand side <code>b</code>.</li><li><code>tol::Real</code>: the requested accuracy on the norm of the residual that is actually used by the algorithm; it defaults to <code>max(atol, rtol*norm(b))</code>. So either use <code>atol</code> and <code>rtol</code> or directly use <code>tol</code> (in which case the value of <code>atol</code> and <code>rtol</code> will be ignored).</li><li><code>maxiter::Integer</code>: the number of iterations of the algorithm. Every iteration involves one application of the linear map and one application of the adjoint of the linear map.</li></ul><p>The default values are given by <code>atol = KrylovDefaults.tol</code>, <code>rtol = KrylovDefaults.tol</code>, <code>tol = max(atol, rtol*norm(b))</code>, <code>maxiter = KrylovDefaults.maxiter</code>; see <a href="../algorithms/#KrylovKit.KrylovDefaults"><code>KrylovDefaults</code></a> for details.</p><p><strong>Algorithms</strong></p><p>The final (expert) method, without default values and keyword arguments, is the one that is finally called, and can also be used directly. Here, one specifies the algorithm explicitly. Currently, only <a href="../algorithms/#KrylovKit.LSMR"><code>LSMR</code></a> is available and thus selected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/KrylovKit.jl/blob/ff6d4752a863f617a8404910007b56c5b7943ed5/src/lssolve/lssolve.jl#L1-L98">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear/">« Linear problems</a><a class="docs-footer-nextpage" href="../eig/">Eigenvalue problems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Sunday 8 June 2025 22:08">Sunday 8 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
